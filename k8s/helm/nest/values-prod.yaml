# Production Environment Values
# Override default values.yaml for production deployment

global:
  environment: prod
  domain: nest.penguintech.io
  region: us-east-1

app:
  replicaCount: 3

  image:
    tag: "v1.0.0"
    pullPolicy: Always

  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

  ingress:
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
      nginx.ingress.kubernetes.io/rate-limit: "100"
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
    hosts:
      - host: nest.penguintech.io
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: nest-prod-tls
        hosts:
          - nest.penguintech.io

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 75

  livenessProbe:
    initialDelaySeconds: 30
    periodSeconds: 10
    failureThreshold: 3

  readinessProbe:
    initialDelaySeconds: 15
    periodSeconds: 5
    failureThreshold: 3

config:
  flask:
    debug: false
    logLevel: WARN
    environment: production

  license:
    enabled: true
    cacheExpiry: 86400

  monitoring:
    metricsEnabled: true

  security:
    tlsEnabled: true
    corsEnabled: true

database:
  type: postgresql
  useExternal: true
  externalConnection:
    host: postgres.prod.svc.cluster.local
    port: 5432
    database: nest_prod

cache:
  useExternal: true
  externalConnection:
    host: redis.prod.svc.cluster.local
    port: 6379
    tls: true

networking:
  enabled: true
  policyTypes:
    - Ingress
    - Egress

networkPolicy:
  enabled: true
  policyTypes:
    - Ingress
    - Egress
  ingress:
    - from:
        - namespaceSelector:
            matchLabels:
              name: ingress-nginx
      ports:
        - protocol: TCP
          port: 8000
  egress:
    - to:
        - namespaceSelector: {}
      ports:
        - protocol: TCP
          port: 5432
        - protocol: TCP
          port: 6379
        - protocol: TCP
          port: 443
        - protocol: TCP
          port: 80

podDisruptionBudget:
  enabled: true
  minAvailable: 2

monitoring:
  enabled: true
  prometheus:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: 30s
      scrapeTimeout: 10s
  grafana:
    enabled: true
    dashboards:
      enabled: true
